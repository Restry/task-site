<template>
  <view class="recharge page-nobar" v-if="user._id">
    <cu-custom bg-color="bg-gradual-blue" class="nav-bar" :isBack="true">
      <block slot="backText">返回</block>
      <block slot="content">充值</block>
    </cu-custom>

    <view class="cu-form-group">
      <view class="title">我的账户余额</view>
      <view class="radius bg-red" :class="allow&&'bg-green'">￥{{user.availableBalance}}</view>
    </view>

    <!-- 相关地址 -->
    <view class="cu-bar bg-white solid-bottom margin-top-sm">
      <view class="action">
        <text class="cuIcon-title text-blue"></text>
        <text class="text-black text-bold">充值金额</text>
      </view>
    </view>
    <view class="bg-white padding-sm padding-tb-sm">
      <view class="money-list">
        <view
          class="money-item"
          :class="item==amount? 'bg-blue':''"
          v-for="item in chargeList"
          @click="selectPrice(item)"
          :key="item"
        >{{item}}</view>
      </view>
    </view>

    <view class="cu-list menu solid-top">
      <view class="cu-item">
        <view class="content">
          <text class="text-black">自定义</text>
        </view>
        <view class="action">
          <input class="text-grey" v-model="amount" name="card" type="number" />
        </view>
      </view>
    </view>

    <view class="cu-list menu solid-top">
      <view class="cu-item">
        <view class="content">
          <text class="text-black">支付方式</text>
        </view>
        <view class="action">
          <radio-group @change="radioChange">
            <label v-for="(item, index) in items" :key="item.value">
              <radio :value="item.value" :checked="index === current" />
              <!-- {{item.name}} -->
              <svg
                v-if="index==0"
                t="1587555088729"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="1152"
                width="200"
                height="200"
              >
                <path
                  d="M902.095 652.871l-250.96-84.392s19.287-28.87 39.874-85.472c20.59-56.606 23.539-87.689 23.539-87.689l-162.454-1.339v-55.487l196.739-1.387v-39.227H552.055v-89.29h-96.358v89.294H272.133v39.227l183.564-1.304v59.513h-147.24v31.079h303.064s-3.337 25.223-14.955 56.606c-11.615 31.38-23.58 58.862-23.58 58.862s-142.3-49.804-217.285-49.804c-74.985 0-166.182 30.123-175.024 117.55-8.8 87.383 42.481 134.716 114.728 152.139 72.256 17.513 138.962-0.173 197.04-28.607 58.087-28.391 115.081-92.933 115.081-92.933l292.486 142.041c-11.932 69.3-72.067 119.914-142.387 119.844H266.37c-79.714 0.078-144.392-64.483-144.466-144.194V266.374c-0.074-79.72 64.493-144.399 144.205-144.47h491.519c79.714-0.073 144.396 64.49 144.466 144.203v386.764z m-365.76-48.895s-91.302 115.262-198.879 115.262c-107.623 0-130.218-54.767-130.218-94.155 0-39.34 22.373-82.144 113.943-88.333 91.519-6.18 215.2 67.226 215.2 67.226h-0.047z"
                  fill="#02A9F1"
                  p-id="1153"
                />
              </svg>
              <svg
                v-if="index==1"
                t="1587555128628"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="2172"
                width="200"
                height="200"
              >
                <path
                  d="M395.846 603.585c-3.921 1.98-7.936 2.925-12.81 2.925-10.9 0-19.791-5.85-24.764-14.625l-2.006-3.864-78.106-167.913c-0.956-1.98-0.956-3.865-0.956-5.845 0-7.83 5.928-13.68 13.863-13.68 2.965 0 5.928 0.944 8.893 2.924l91.965 64.43c6.884 3.864 14.82 6.79 23.708 6.79 4.972 0 9.85-0.945 14.822-2.926L861.71 282.479c-77.149-89.804-204.684-148.384-349.135-148.384-235.371 0-427.242 157.158-427.242 351.294 0 105.368 57.361 201.017 147.323 265.447 6.88 4.905 11.852 13.68 11.852 22.45 0 2.925-0.957 5.85-2.006 8.775-6.881 26.318-18.831 69.334-18.831 71.223-0.958 2.92-2.013 6.79-2.013 10.75 0 7.83 5.929 13.68 13.865 13.68 2.963 0 5.928-0.944 7.935-2.925l92.922-53.674c6.885-3.87 14.82-6.794 22.756-6.794 3.916 0 8.889 0.944 12.81 1.98 43.496 12.644 91.012 19.53 139.48 19.53 235.372 0 427.24-157.158 427.24-351.294 0-58.58-17.78-114.143-48.467-163.003l-491.39 280.07-2.963 1.98z"
                  fill="#09BB07"
                  p-id="2173"
                />
              </svg>
              <svg
                v-if="index==2"
                t="1587555160698"
                class="icon"
                viewBox="0 0 1663 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="3149"
                width="200"
                height="200"
              >
                <path
                  d="M363.549761 920.595388L479.304057 404.596138h-4.031244a36.025245 36.025245 0 0 0-13.949385 4.095232 632.841342 632.841342 0 0 1-11.965756 51.638318c-6.014872 26.810973-6.014872 30.906205-7.9985 45.431482l-1.983629 1.983628h-49.910641l-1.91964-2.047616 11.901768-49.526714c9.982128-45.431482 11.965756-61.940386 15.997001-84.656127l1.91964-2.047616c22.011873-4.095232 27.962757-4.095232 53.941886-8.254452l1.983628 2.047616-3.967257 14.461288c3.967256-2.047616 7.934512-6.206836 11.965757-8.254452 1.91964-2.047616 3.967256-2.047616 7.934512-4.095232l59.89277-262.158845C561.080724 45.431482 616.878262 0 670.820148 0H307.688235c-55.861526 0-109.739424 45.431482-121.70518 103.212648L2.465464 920.595388C-9.56428 978.376554 24.349361 1023.808036 78.227259 1023.808036h361.148284c-55.861526 0-89.775167-47.479098-75.825782-103.212648z m-35.897269-429.359495c-17.916641 10.366056-43.89577 16.508905-71.858527 16.508905-21.947885 0-59.828782-4.095232-71.794539-26.810973a42.488033 42.488033 0 0 1-7.9985-26.874961l4.031244-37.113041 1.91964-10.302069 29.946385-134.18284 2.047617-8.254453s9.982128 2.047616 65.843654 0v2.047616c-6.014872 16.508905-33.913641 134.182841-33.913641 134.182841l-6.014873 35.065425v6.206837c1.983628 16.508905 11.965756 26.874961 29.946385 26.87496 11.965756 0 19.900269-4.15922 29.882398-10.366056 14.013372-12.349684 17.916641-30.970193 23.931512-57.781166 0 0 27.962757-130.023621 27.962757-138.278073 3.967256 0 15.997001 2.047616 55.861526 0v2.047616c-6.014872 16.508905-33.913641 140.389677-33.913641 140.389677l-3.967256 12.349685c-4.031244 26.874961-11.965756 55.73355-41.912141 74.29007z"
                  fill="#D43634"
                  p-id="3150"
                />
                <path
                  d="M824.967245 922.579016l29.882397-136.166468h-35.833281c-5.950884 0-9.982128 0-13.949385-2.111604-3.967256-2.047616-7.934512-6.142848-7.934512-10.302069s1.91964-10.302068 3.967256-18.55652l61.748422-210.520528h43.831782l-6.014872 22.651753 6.014872-6.142848 11.965756-51.638318h-27.898769v-2.047616c1.91964-8.254452 3.967256-18.556521 5.950885-26.874961l1.983628-12.349685c4.031244-18.556521 7.9985-41.272261 7.9985-49.526713 0-4.15922 1.91964-14.461289-9.982128-14.461289a59.828782 59.828782 0 0 0-15.933013 4.15922 633.609198 633.609198 0 0 1-11.965756 51.57433c-5.950884 26.874961-5.950884 30.970193-7.934513 45.431482l-1.983628 2.047616h-49.846654l-1.91964-2.047616 11.901769-49.526714c9.982128-45.431482 11.965756-61.940386 13.949384-84.656127l1.983628-2.047616c21.947885-4.15922 27.898769-4.15922 53.749922-8.31844l2.047616 2.111604-4.031244 14.461288c4.031244-2.047616 7.9985-6.206836 11.965757-8.31844 11.965756-6.142848 23.931513-8.190464 31.866025-8.190464 6.014872 0 11.965756 0 17.91664 4.095232l57.781166-262.094857C1018.211012 45.431482 1074.00855 0 1129.7421 0H697.503145c-55.73355 0-109.54746 45.431482-121.513217 103.212648L518.336738 365.307505c9.91814-4.095232 17.916641-4.095232 23.867525-4.095232 9.982128 0 21.947885 4.095232 27.898769 16.508904 3.967256 12.349684 1.983628 26.874961-3.967256 53.685934l-3.967256 14.397301c-6.014872 30.970193-7.9985 37.113041-9.982129 57.781166l-6.014872 6.206836h-49.782666v-2.047616c1.983628-8.254452 4.031244-18.556521 6.014873-26.874961l1.91964-12.349685c4.031244-18.556521 7.9985-41.272261 7.9985-49.526713 0-4.15922 1.983628-12.413672-5.950884-14.461289l-115.562332 515.99925C378.842893 978.376554 412.756535 1023.808036 466.506456 1023.808036h434.222584c-53.749922 2.047616-87.663563-45.431482-75.697807-101.101044z m15.997001-361.148284l-9.982129 33.017809h-69.746922l-7.934513 6.206836c-3.967256 4.095232-3.967256 2.047616-7.9985 4.095232a49.270762 49.270762 0 0 1-23.867525 6.206836h-21.947884l9.982128-30.970193h5.950884c6.014872 0 9.982128 0 11.965757-2.047616a56.117478 56.117478 0 0 0 7.9985-10.366056l11.901768-24.763357h51.830282l-7.9985 18.556521h49.846654z m-185.245267-171.35987l-9.982128 41.336249c-1.983628 8.254452-3.967256 18.556521-5.950885 26.810973-4.031244 18.556521-6.014872 26.874961-7.9985 30.970193s-1.983628 8.254452-3.967256 18.556521h-57.781166c1.983628-10.302068 3.967256-14.461289 5.950884-18.556521 2.047616-4.15922 2.047616-8.31844 6.014872-18.55652 3.967256-14.461289 5.950884-24.827345 7.934513-35.129414 1.983628-8.254452 6.014872-33.017809 7.9985-41.272261-1.983628-6.206836 1.983628-12.413672 9.91814-18.556521 11.965756-8.31844 29.882397-10.366056 41.848154-4.15922 7.9985 4.15922 9.982128 12.413672 6.014872 18.556521z m9.91814 47.479097c3.967256-18.556521 11.965756-39.224645 25.915141-53.621946 21.883897-20.668125 47.799038-20.668125 59.764794-20.668124 17.916641 0 37.816909 4.15922 47.799038 18.55652 5.950884 8.31844 11.965756 24.763357 5.950884 55.73355-1.91964 10.366056-7.934512 33.017809-21.883896 47.479098-17.916641 18.556521-39.864525 24.763357-63.732051 24.763357a95.982003 95.982003 0 0 1-31.866025-6.206836c-29.882397-12.349684-25.915141-45.431482-21.947885-66.035619z m107.563832 348.862589h-57.781166c-3.967256 0-7.934512 0-13.885396-2.111604a43.25589 43.25589 0 0 1-9.982129-6.142849c-1.983628-4.15922-6.014872-6.206836-3.967256-14.461288l15.933013-57.781166h-27.898769l9.91814-33.081797h27.898769l7.9985-26.810973h-27.898769l9.982129-30.970193h125.416484l-9.91814 30.970193h-49.782666l-7.9985 26.874961h51.830282l-7.998501 33.017809h-51.830282l-11.901768 43.319877c-1.983628 4.095232 11.965756 6.206836 17.916641 6.206837l25.915141-4.159221-11.965757 35.129414z"
                  fill="#034582"
                  p-id="3151"
                />
                <path
                  d="M878.909131 567.89352l-9.27826 34.745485s3.711304-2.047616 7.422608-6.142848l5.566956-28.602637h-3.711304z m-159.778042-97.901643c5.566956 0 9.27826-4.095232 12.989565-10.238081 5.566956-8.126476 9.27826-28.538649 11.133912-32.633881 5.566956-24.507405 3.711304-38.776729-7.422608-38.776729-14.845217 0-20.476161 20.412173-25.979129 42.871961a114.6665 114.6665 0 0 0-3.775292 22.395801c3.775292 16.380929 13.053552 16.380929 13.053552 16.380929z m117.098044 257.103793c-1.91964 6.142848-1.91964 10.23808-1.91964 10.23808 1.91964 1.983628 3.711304 4.031244 5.566957 4.031244h5.566956l16.764856-79.601075h-9.342248l-16.636881 65.331751z m29.690433-110.18734l-3.711304 14.269324h9.278261l3.711304-14.269324h-9.278261z"
                  fill="#034582"
                  p-id="3152"
                />
                <path
                  d="M1236.666051 471.079673c6.334812 0 16.956821-4.095232 21.116041-10.302069 2.175592-2.111604 4.287196-8.31844 6.3988-12.413672 2.111604-6.206836 4.287196-14.525277 4.287197-20.732113 2.111604-4.095232 2.111604-8.254452 2.111604-12.413672 2.111604-16.508905-4.287196-26.874961-14.845217-26.874961-16.956821 0-23.355621 20.668125-29.690433 43.447853-2.111604 8.31844-4.223208 16.572893-4.223208 22.779729 4.223208 16.508905 14.845217 16.508905 14.845216 16.508905z m-286.218334 163.489345l4.223209-14.525276h-67.827283l-4.223208 14.525276h57.269262c8.446416 0 10.55802 2.047616 10.55802 0z"
                  fill="#107C84"
                  p-id="3153"
                />
                <path
                  d="M1542.656678 0h-408.69137c-58.037118 0-114.090608 45.49547-128.615885 103.404612l-60.148722 262.670749c4.15922 2.111604 8.31844 6.206836 10.366057 12.413672 4.15922 12.413672 2.111604 26.874961-4.159221 53.749922l-4.095232 14.525277c-6.270824 31.034181-8.31844 37.241017-10.366056 57.909142l-2.111604 2.047616h-22.843717l-12.413672 51.702306c4.15922-4.095232 12.413672-8.254452 16.63688-10.302069 10.302068-4.15922 33.145785-8.31844 33.145785-8.31844h72.626383l-24.955321 82.736487c-4.095232 14.525277-8.254452 22.779729-12.413672 26.874961a35.193401 35.193401 0 0 1-12.413673 12.413672 33.145785 33.145785 0 0 1-16.63688 6.206836h-82.992439l-18.620509 80.688871 24.891333-2.047616-10.366056 37.241018h-20.796101l-33.145785 136.486408c-12.47766 57.909142 22.779729 103.404612 78.833218 103.404612h408.691371c58.037118 0 114.090608-45.49547 128.615884-103.404612L1621.489897 103.404612C1633.967557 45.49547 1598.710168 0 1542.656678 0z m-292.489158 361.980129c8.31844 4.095232 14.525277 8.254452 18.684497 14.461288v-6.206836l2.047616-2.047616c24.955321-4.15922 31.162157-4.15922 58.101106-8.31844v2.111604c-4.15922 18.556521-10.366056 39.288633-14.525277 57.909142-10.366056 41.336249-12.413672 62.068362-16.63688 82.736487l-2.047616 2.047616h-53.941886l-2.047616-2.047616c0-2.111604 2.047616-6.206836 2.047616-8.318441-8.31844 6.206836-16.572893 12.413672-26.938949 12.413673-10.366056 0-18.684497-2.047616-29.050553-6.206836-31.098169-12.413672-27.002937-47.543086-22.843717-66.163595 4.15922-18.620509 12.47766-39.288633 27.002937-53.749922 22.779729-18.620509 47.671062-22.779729 60.148722-18.620508z m-282.18709 144.740861l39.480597-163.36137 16.636881-74.482035s2.047616-6.206836 2.047616-8.31844c8.31844 0 24.891333 2.111604 70.514779 0h16.63688c35.193401 0 64.243954 0 80.880835 20.732113 6.206836 8.31844 8.31844 18.556521 8.31844 28.922577 0 8.31844-2.111604 16.636881-2.111604 22.779729-6.206836 26.874961-20.732113 49.65469-39.416609 64.115978-29.050553 22.779729-68.467162 22.779729-101.676936 22.779729h-4.15922l-4.095232 4.095232c0 2.111604-8.31844 33.081797-8.31844 33.081797s-8.31844 43.511842-10.366057 51.766294c-10.366056-2.111604-27.002937-2.111604-64.307942-2.111604z m14.589265 188.252702a33.273761 33.273761 0 0 1-8.318441 14.461289c-4.15922 4.15922-10.366056 8.31844-24.891333 8.31844h-24.891333v22.715741c0 6.206836 2.047616 6.206836 2.047617 6.206836s2.111604 2.047616 4.15922 2.047616h8.31844l24.891333-2.047616-12.477661 37.241018h-26.938949c-18.684497 0-33.209773 0-39.416609-4.159221-4.15922-2.047616-6.206836-6.206836-4.15922-12.413672l2.111604-88.943323h43.511842v18.556521h10.430044c4.095232 0 6.206836 0 8.31844-1.983629 2.047616-2.111604 2.047616-2.111604 2.047616-4.15922l4.095232-14.461288h35.321378l-4.15922 18.55652z m153.507217 88.943324h-47.73505l4.15922-10.366057h-95.406111l10.366056-31.034181h10.366057l49.782666-167.52059 10.366056-33.081797h47.73505l-4.159221 16.508905s12.413672-8.254452 24.891333-12.413673c10.366056-2.047616 60.148722-4.095232 76.785603-4.095232h51.830282v18.556521c0 4.15922 2.047616 4.15922 8.31844 4.15922h8.31844l-8.31844 33.081797h-27.002937c-24.891333 2.111604-33.145785-8.254452-33.145785-20.668125v-18.55652l-4.15922 16.508904h-16.636881l-49.782665 165.472974h12.47766l-10.366056 33.081797h-14.525277l-4.15922 10.366057z m213.719927-146.852466h-51.894269l-8.318441 26.874961h51.830282l-8.31844 26.874961h-55.989502l-10.366056 12.413673h22.843716l6.206837 35.193401c0 4.095232 0 6.142848 2.111604 8.254452 2.047616 2.047616 8.31844 2.047616 12.413672 2.047616h6.206836l-10.366056 35.193402h-29.050553c-6.206836 0-8.31844-4.15922-12.413673-6.206837-4.15922-2.111604-8.31844-6.206836-8.31844-12.413672l-6.206836-35.193401-24.891333 35.193401c-8.31844 10.302068-18.684497 18.556521-37.368993 18.556521h-35.193401l10.302068-30.970194h14.525276c4.15922 0 8.31844-2.111604 10.366057-2.111604 2.111604-2.047616 4.15922-2.047616 8.31844-6.206836l37.368993-51.702306H1183.811962l8.31844-28.922577h55.989502l8.31844-26.874961h-56.05349l10.366057-31.034181h155.618821l-16.636881 31.034181z m33.145786-97.261763l-2.111604 2.111604-20.732113 35.193401c-6.206836 12.349684-18.684497 20.604137-37.305005 20.604137h-31.162158l10.430045-30.970193h6.206836c4.15922 0 6.206836 0 8.31844-2.111604 2.047616 0 2.047616-2.047616 4.095232-4.095232l10.366057-18.620509c16.636881-24.827345 20.796101-35.193401 37.368993-62.068362-2.047616-31.034181-4.15922-41.336249-6.206836-59.956758a227.221396 227.221396 0 0 1-4.15922-37.241018c-2.111604-24.827345-2.111604-20.668125-6.206836-37.241017v-2.047616l2.047616-2.111604c24.955321-2.047616 24.955321-4.095232 51.830281-8.254452l2.111604 2.047616 4.159221 68.275198v4.15922c14.525277-31.034181 14.525277-22.779729 31.098169-62.068362v-2.047616l2.111604-2.111604c22.779729-2.047616 26.938949-4.095232 53.877898-8.254452l2.111604 2.047616c-2.111604 0-103.724552 175.83903-118.249828 204.761607z"
                  fill="#107C84"
                  p-id="3154"
                />
                <path
                  d="M948.272125 589.137537l5.758921-19.324377h-65.587703l-5.75892 30.074361c9.5982-6.462788 19.196401-10.749984 28.922577-10.749984h36.665125z m135.142661-227.349372c13.501468-6.3988 23.163657-21.435981 25.083297-38.584766 3.83928-19.324377-1.91964-32.185965-13.437481-38.648753l-32.889833-2.111604h-5.75892v6.3988l-15.485096 75.057927v4.287196h7.67856c11.645816 0 25.147285 0 34.809473-6.3988z m-36.665125 379.576829h36.665125l9.5982-38.584765h-36.601137l-9.662188 38.584765z m46.327313-171.551834l-11.581828 42.871962s13.501468-6.3988 21.244017-8.574393c7.67856-2.111604 19.260389-2.111604 19.260388-2.111604l7.742549-32.185965h-36.665126z m-30.906205 109.419484s13.501468-8.63838 21.244017-10.749984c7.67856-2.175592 19.324377-4.287196 19.324377-4.287197l9.5982-32.185965h-36.665125l-13.437481 47.159158z"
                  fill="#107C84"
                  p-id="3155"
                />
              </svg>
            </label>
          </radio-group>
        </view>
      </view>
    </view>

    <view v-show="isBank">
      <view class="cu-bar bg-white solid-bottom margin-top-sm">
        <view class="action">
          <text class="cuIcon-title text-blue"></text>
          <text class="text-black text-bold">
            银行转账
            <text class="text-sm">[点击文字复制]</text>
          </text>
        </view>
      </view>
      <view class="bg-white padding-sm padding-tb-sm">
        <view class="cu-list menu">
          <view class="cu-item" @click="copy(config.openBank)">
            <view class="content">
              <text class="text-black">开户行</text>
            </view>
            <view class="action">
              <text class="text-grey">{{config.openBank}}</text>
            </view>
          </view>

          <view class="cu-item" @click="copy(config.cardName)">
            <view class="content">
              <text class="text-black">姓名</text>
            </view>
            <view class="action">
              <text class="text-grey">{{config.cardName}}</text>
            </view>
          </view>

          <view class="cu-item" @click="copy(config.card)">
            <view class="content">
              <text class="text-black">卡号</text>
            </view>
            <view class="action">
              <text class="text-grey">{{config.card}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    <view class="padding flex flex-direction">
      <button class="cu-btn bg-blue margin-tb-sm lg" :disabled="amount==0" @click="submit">提 交</button>
    </view>

    <!-- 相关地址 -->
    <!-- <view class="cu-bar bg-white solid-bottom margin-top-sm">
      <view class="action">
        <text class="cuIcon-title text-blue"></text>
        <text class="text-black text-bold">温馨提示</text>
      </view>
    </view>
    <view class="bg-white padding-sm padding-tb-sm">
      <ol>
        <li>请务必填写清楚开户银行具体名称，如：中国银行北京市海淀支行</li>
        <li>最低提现 10 元，手续费 0%。</li>
        <li>提现时，系统将自动扣除2%的红利给到你的推荐人，同样，你推荐的人在提现时一样返你2%，推荐越多红利越多。</li>
        <li>每天可提现， 24 小时到账</li>
      </ol>
    </view>-->
    <!-- 相关地址 -->
    <view class="cu-bar bg-white solid-bottom margin-top-sm">
      <view class="action">
        <text class="cuIcon-title text-blue"></text>
        <text class="text-black text-bold">充值明细</text>
      </view>
    </view>
    <view class="bg-white padding-sm padding-tb-sm" @click="copyUrl">
      <view class="cu-list menu">
        <view class="cu-item" v-for="item in details" :key="item._id">
          {{dayjs(item.created).fromNow()}}:
          <text class="text-grey">金额：</text>
          <text class="text-red">{{item.processAmount}}</text>
          <text class="cuIcon-title text-blue">状态</text>
          {{item.processStatus}}
        </view>
      </view>
    </view>
  </view>
</template>

<script>
import { mapActions, mapState } from "vuex";
import request from "../../utils/request";
import { dayjs } from "../../utils/tools";
import h5Copy from "@/js_sdk/junyi-h5-copy/junyi-h5-copy.js";

export default {
  data() {
    return {
      details: [],
      allow: false,
      chargeList: [300, 500, 1000, 3000, 6000, 10000],
      amount: 0,
      items: [
        {
          value: "ali",
          name: "支付宝"
        },
        {
          value: "wechat",
          name: "微信",
          checked: "true"
        },
        {
          value: "bank",
          name: "银行卡"
        }
      ],
      current: 0
    };
  },

  computed: {
    ...mapState("user", ["user", "config"]),
    isBank() {
      return this.current == 2;
    },
    payment() {
      return this.items[this.current];
    }
  },
  methods: {
    dayjs,
    // ...mapActions("user", ["refreshUser"]),
    copy(value) {
      const result = h5Copy(value);
      if (result === true) {
        uni.showToast({
          title: "复制成功:" + value
        });
      } else {
        uni.showToast({
          title: "复制失败",
          icon: "none"
        });
      }
    },
    radioChange: function(evt) {
      for (let i = 0; i < this.items.length; i++) {
        if (this.items[i].value === evt.target.value) {
          this.current = i;
          break;
        }
      }
    },
    selectPrice(price) {
      this.amount = price;
    },
    submit(e) {
      request
        .post("/utils/pay", {
          userId: this.user._id,
          amount: this.amount,
          payment: this.payment.value
        })
        .then(({ data }) => {
          if (data.ok) {
            uni.showToast({
              title: "请继续支付...",
              icon: "none",
              duration: 3000,
              success: () => {
                !this.isBank && window.open(data.ops[0].trade_qrcode);
              }
            });
            this.details.splice(0, 0, data.ops[0]);

            this.refreshUser();
          } else {
            uni.showToast({
              title: data.message,
              icon: "none",
              duration: 3000
            });
          }
        });
    },
    onReady() {
      request
        .get("/api/recharge", { params: { userId: this.user._id } })
        .then(({ data }) => {
          this.details = data;
        });
    }
  }
};
</script>

<style lang="scss" scoped>
 
.recharge {
  .radius {
    padding: 0 10upx;
  }
  .cu-item {
    .action {
      .text-grey {
        text-align: right;
      }
    }
  }
  uni-radio-group {
    display: flex;
  }
  .uni-label-pointer {
    display: flex;
    align-items: center;

    .icon {
      width: 45px;
      height: 45px;
    }
  }

  .money-list {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;

    .money-item {
      flex: 20%;
      height: 50px;
      align-items: center;
      justify-content: center;
      display: flex;
      margin: 10px;
      border-radius: 10px;
      box-shadow: 2px 3px 4px 1px #e2e2e2;
      // background-color: whitesmoke;
      font-size: 1.1em;
    }
  }
}
</style>
